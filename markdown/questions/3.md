# 3. Значимость выборочного коэффициента корреляции. Проверка гипотезы о значимости выборочного коэффициента корреляции Пирсона: постановка задачи, используемый критерий, алгоритм проверки нулевой гипотезы. [[⇧]](../questions-list.md)

## Значимость выборочного коэффициента корреляции

**Выборочный коэффициент корреляции** $r_{в}$ — **оценка** коэффициента корреляции $r_{г}$ генеральной совокупности.

> Вся генеральная совокупность обычно не доступна для анализа, и коэффициент корреляции (как и другие статистические показатели) **вычисляется по выборке**.

## Проверка гипотезы о значимости выборочного коэффициента корреляции Пирсона

### Постановка задачи

`Предположим:` Выборочный коэффициент корреляции $r_{в}$ оказался отличным от нуля.

`Вопрос:` Является ли это отличие **значимым** — означает ли оно, что коэффициент корреляции $r_{г}$ генеральной совокупности также отличен от нуля, и можно предполагать наличие линейной связи между признаками в генеральной совокупности?

`Решение:` Проверка гипотезы о значимости выборочного коэффициента корреляции:

$H_{0}: r_{г} = 0$, корреляция **отсутствует**.

$H_{1}: r_{г} \ne 0$, корреляция **существует**.

### Используемый критерий

В качестве **критерия** для проверки нулевой гипотезы используется статистика:

$$T = r_{в} \cdot \frac{\sqrt{n-2}}{\sqrt{1-r_{в}^{2}}}$$

$r_{в}$ – выборочный коэффициент корреляции Пирсона.

$n$ – число наблюдений (объем выборки).

При справедливости нулевой гипотезы величина $T$ имеет **распределение Стьюдента**, с $k = n - 2$ степенями свободы.

> Поскольку конкурирующая гипотеза имеет вид $r_{г} \ne 0$, то **критическая область двусторонняя**.

### Алгоритм проверки нулевой гипотезы Ⅰ

1. По данным выборки найти **наблюдаемое** значение критерия:

   $$t_{набл} = r_{в} \cdot \frac{\sqrt{n-2}}{\sqrt{1-r_{в}^{2}}}$$

   $r_{в}$ – выборочный коэффициент корреляции Пирсона.

   $n$ – число наблюдений (объем выборки).

2. По таблице критических точек распределения Стьюдента для выбранного уровня значимости найти **критическую точку**:

   $$t_{кр} = t_{дв.к.}(\alpha, k) = t_{дв.к.}(\alpha, n - 2)$$

   $t_{дв.к.}$ – значение двухсторонней[^1] критической области.

   $\alpha$ – уровень значимости[^2].

   $k$ – количество степеней свободы.

3. Если:
   - $|t_{набл}| \le |t_{кр}|$, то **нет оснований отвергнуть** нулевую гипотезу.
   - $|t_{набл}| \gt |t_{кр}|$, то нулевая гипотеза **должна быть отвергнута** как противоречащая данным наблюдений.

### Алгоритм проверки нулевой гипотезы Ⅱ

1. По данным выборки найти значение выборочного коэффициента корреляции $r_{в}$.

2. Используя статистику $T$, найти $p\text{-}value$ — вероятность того, что при условии справедливости нулевой гипотезы (признаки некоррелированны) по данным выборки будет получен выборочный коэффициент корреляции, не меньший $r_{в}$:
   $$p\text{-}value = P(T \ge t_{набл}) $$
3. Сравнить значение $p\text{-}value$ с заданным уровнем значимости $\alpha$:
   - $p\text{-}value \gt \alpha$, нулевая гипотеза **принимается**.
   - $p\text{-}value \le \alpha$, нулевая гипотеза **отвергается**.

[^1]: Если распределение симметрично, то при односторонней критической области уровень значимости берется делённый на 2.
[^2]: Вероятность ошибки если нулевая гипотеза отвергнута.
